plugins {
    id 'base'
    id("org.barfuin.gradle.taskinfo") version "2.2.0"
    id 'java'
}

base {
    archivesName = 'ds'
}

repositories {
    mavenCentral()
    google()
}

dependencies {
    // https://mvnrepository.com/artifact/commons-beanutils/commons-beanutils
    implementation ('commons-beanutils:commons-beanutils:1.11.0') {
        exclude group: 'commons-collections', module: 'commons-collections'
    }
}

description 'Just a demo'
group 'com.tomgregory'
version '1.0-SNAPSHOT'

import org.apache.tools.ant.filters.ReplaceTokens

tasks.register('generateDsNew', Copy) {
    group "Description"
    description "create ds in build and tokens"

    from 'description'
    into "$buildDir/description"
    filter(ReplaceTokens, tokens: [THEME_PARK_NAME: "Gorly world of darknes"])
}

TaskProvider<Copy> generateDsNew_B = tasks.register('generateDsNew_B', Copy) {
    group "Description"
    description "also have excluded files"

    from 'description'
    into "$buildDir/description_B"

    exclude 'rolers*', 'true*'
    filter(ReplaceTokens, tokens: [THEME_PARK_NAME: "Bee"])

}

tasks.register("ZipDs", Zip) {
    group "Description"
    description "zip descriptions"

    from tasks.named("generateDsNew")
    into "descriptions/some/"
    destinationDirectory = layout.buildDirectory.dir("zip")

}

